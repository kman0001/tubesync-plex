# TubeSync Plex Metadata Sync (Personal Update)

This repository is a **personal fork** of [tgouverneur/tubesync-plex](https://github.com/tgouverneur/tubesync-plex) and has been updated for **personal use**.

## Key Changes in this Fork
- Simplified default log output
- Added `-d / --detail` option for detailed metadata updates
- Disallow simultaneous use of `-s / --silent` and `-d / --detail` options

> ⚠️ **Note:** This fork is maintained for personal purposes and may differ from the original repository.

====

# TubeSync Plex Metadata Sync Tool

This repository contains a Python script and a shell script to synchronize Plex media metadata using NFO files generated by TubeSync. It supports video files (.mkv, .mp4, .avi, .mov, .wmv, .flv, .m4v) and can upload subtitles to Plex.

## Features

* Read metadata from NFO files for video files.
* Update Plex metadata: title, aired date, summary.
* Delete NFO files after successful update.
* Optional subtitle upload.
* Configurable via `config.ini`.
* Detailed logging available with `-d` option.
* Silent mode available with `-s` option.

---

## Requirements

* Python 3.x
* plexapi library (`pip install plexapi`)
* lxml library (`pip install lxml`)

---

## Configuration (`config.ini`)

The script uses a `config.ini` file to store Plex server details. If the file does not exist, it will be automatically created with default values. You must update it before running the script.

Example `config.ini`:

```ini
[DEFAULT]
plex_base_url = http://localhost:32400
plex_token = YOUR_PLEX_TOKEN
plex_library_name = YOUR_LIBRARY_NAME
```

* **plex\_base\_url**: The URL of your Plex server.
* **plex\_token**: Your Plex API token.
* **plex\_library\_name**: Name of the Plex library to sync.

---

## Python Script Usage

```bash
python tubesync-plex-metadata.py [-c CONFIG] [-s] [-d] [--all] [--subtitles]
```

Options:

* `-c`, `--config`: Path to config file (default: `./config.ini`).
* `-s`, `--silent`: Run in silent mode (minimal output).
* `-d`, `--detail`: Show detailed update logs.
* `--all`: Update all episodes in the library.
* `--subtitles`: Upload subtitles to Plex.

Example:

```bash
python tubesync-plex-metadata.py --all --subtitles -d
```

---

## Shell Script Usage (`update_tubesync.sh`)

The shell script automates pulling the latest code from GitHub, setting up a Python virtual environment, installing dependencies, and running the Python script.

```bash
#!/bin/bash

LOG_PREFIX="[$(date '+%Y-%m-%d %H:%M:%S')"]
CONFIG_FILE="./config.ini"

echo "$LOG_PREFIX START"

# Pull latest updates from GitHub
if [ -d .git ]; then
    echo "$LOG_PREFIX Updating repository..."
    git reset --hard
    git pull
else
    echo "$LOG_PREFIX Cloning repository..."
    git clone https://github.com/kman0001/tubesync-plex.git .
fi

# Create virtual environment if missing
if [ ! -d venv ]; then
    echo "$LOG_PREFIX Creating virtual environment..."
    python3 -m venv venv
fi

# Install dependencies
./venv/bin/pip install --upgrade pip
./venv/bin/pip install -r requirements.txt

# Run Python script
./venv/bin/python tubesync-plex-metadata.py -c "$CONFIG_FILE"

echo "$LOG_PREFIX END"
```

### Notes

* Make the script executable:

```bash
chmod +x update_tubesync.sh
```

* Run the script:

```bash
./update_tubesync.sh
```

---

## Modifying the Shell Script

* Update the `CONFIG_FILE` path if your config.ini is in a different location.
* Modify GitHub URL if your repository changes.
* You can add additional Python flags (`-d`, `--all`, `--subtitles`) inside the script.

---

## Important Notes

* Ensure your Plex server is accessible and the token is correct.
* NFO files are deleted **only after successfully updating metadata**.
* Detailed logs are available with the `-d` option.
* The script works for common video extensions: `.mkv`, `.mp4`, `.avi`, `.mov`, `.wmv`, `.flv`, `.m4v`.


